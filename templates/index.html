<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Trends Visualization</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
    <style>
        .header-container {
            display: flex;
            align-items: center;
            gap: 20px; /* Adjust the gap */
        }

        form {
            margin-right: 10px; /* Adjust margin*/
        }


    </style>

    <script>
  document.addEventListener('DOMContentLoaded', function () {
    // Set the selected option based on the query parameter in the URL
    var urlParams = new URLSearchParams(window.location.search);
    var urlDuration = urlParams.get('duration');

    console.log('URL Duration:', urlDuration);

    // Update the select element only if the URL parameter is valid
    if (urlDuration && ['daily', 'weekly', 'monthly'].includes(urlDuration)) {
        console.log('Setting value:', urlDuration);
        document.getElementById('time_span').value = urlDuration;
    } else {
        console.log('Invalid or missing URL duration:', urlDuration);
    }
});
    function updateFormAction() {
        var selectedOption = document.getElementById('time_span').value;
        var form = document.getElementById('time_span_form');
        form.action = "{{ url_for('index') }}?duration=" + selectedOption;
        form.submit(); // Manually submit the form
    }

    </script>
</head>

<body>
<div class="header-container">
    <h1>Trending Repositories</h1>
    <form id="time_span_form" method="post">
        <label for="time_span">Select time span:</label>
        <select id="time_span" name="time_span" onchange="updateFormAction()">
            <option value="daily" {% if selected_option=='today' %}selected{% endif %}>Today</option>
            <option value="weekly" {% if selected_option=='this_week' %}selected{% endif %}>This Week</option>
            <option value="monthly" {% if selected_option=='this_month' %}selected{% endif %}>This Month</option>
        </select>
        <button type="submit">Submit</button>
    </form>
    <form action="{{ url_for('graph') }}" method="post">
        <button type="submit" name="show_graph">Show Graph</button>
    </form>
    <form action="{{ url_for('pieChart') }}" method="post">
        <button type="submit" name="show_pieChart">Show Pie Chart</button>
    </form>
    <form action="{{ url_for('boxPlot') }}" method="post">
        <button type="submit" name="show_boxPlot">Show Box Plot</button>
    </form>
</div>


<main id="main">
    {% for repository in repoList %}
    <div class="repository">
        <h2>{{ repository.name }}</h2>
        <p>Owner: {{ repository.owner }}</p>
        <p>Description: {{ repository.description }}</p>
        <p>Language: <span class="language">{{ repository.language }}</span></p>
        <p>Total Stars: {{ repository.stars_total }}</p>
        <p class="stars">{{ repository.stars_today }}</p>
    </div>
    {% endfor %}
</main>
</body>

</html>